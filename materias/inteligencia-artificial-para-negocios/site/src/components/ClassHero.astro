---
import type { ImageMetadata } from "astro";

interface Metric {
  value: string;
  label: string;
  accent: "red" | "cyan";
}

interface CTA {
  label: string;
  href: string;
  icon?: string;
}

interface Props {
  classNumber: string;
  title: string;
  subtitle: string;
  date: string;
  duration: string;
  modality: string;
  vinylImage?: ImageMetadata;
  haloImage?: ImageMetadata;
  metrics: Metric[];
  stack?: string[];
  ctas?: CTA[];
}

const {
  classNumber,
  title,
  subtitle,
  date,
  duration,
  modality,
  vinylImage,
  haloImage,
  metrics,
  stack,
  ctas
} = Astro.props as Props;
---

<section class="class-hero relative overflow-hidden">
  <!-- Vinyl background with halo -->
  {(haloImage || vinylImage) && (
    <div class="class-hero__background">
      {haloImage && (
        <img
          src={haloImage.src}
          alt=""
          class="absolute inset-0 h-full w-full object-cover opacity-40 blur-2xl"
          aria-hidden="true"
        />
      )}
      {vinylImage && (
        <img
          src={vinylImage.src}
          alt={`Vinilo holográfico de ${title}`}
          class="class-hero__vinyl"
        />
      )}
    </div>
  )}

  <!-- Overlay gradient -->
  <div class="class-hero__overlay" />

  <!-- Content -->
  <div class="class-hero__content">
    <!-- Breadcrumb -->
    <nav class="class-hero__breadcrumb" aria-label="Navegación de clase">
      <a href="/" class="class-hero__breadcrumb-link">
        Orbital Vinyl Collection
      </a>
      <span class="class-hero__breadcrumb-separator">/</span>
      <span class="class-hero__breadcrumb-current">Clase {classNumber}</span>
    </nav>

    <!-- Main content - Two column layout on desktop -->
    <div class="grid gap-8 lg:grid-cols-[1.2fr_1fr] lg:gap-12">
      <!-- Left column: Title and info -->
      <div class="space-y-6">
        <!-- Badge -->
        <div class="flex items-center gap-4">
          <span class="inline-flex items-center gap-2 rounded-full border border-red-400/40 bg-red-500/20 px-4 py-1 text-xs uppercase tracking-[0.3em] text-red-200 backdrop-blur">
            <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10" stroke-width="2" />
              <circle cx="12" cy="12" r="3" fill="currentColor" />
            </svg>
            Clase {classNumber}
          </span>
          <span class="text-sm text-slate-300/70">{date}</span>
        </div>

        <!-- Title -->
        <h1 class="class-hero__title">
          <span class="text-red-300 md:text-red-400">Clase {classNumber}</span>
          <br />
          <span class="bg-gradient-to-r from-white via-white/90 to-red-200 bg-clip-text text-transparent drop-shadow-[0_15px_35px_rgba(237,32,36,0.45)]">
            {title}
          </span>
        </h1>

        <!-- Subtitle -->
        <p class="max-w-2xl text-lg leading-relaxed text-slate-100/85">
          {subtitle}
        </p>

        <!-- Metadata -->
        <div class="flex flex-wrap gap-4 text-sm text-slate-300/75">
          <div class="flex items-center gap-2">
            <svg class="h-4 w-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>{duration}</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="h-4 w-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>{modality}</span>
          </div>
        </div>

        <!-- CTAs -->
        {ctas && ctas.length > 0 && (
          <div class="flex flex-wrap gap-3 pt-2">
            {ctas.map((cta, index) => (
            <a
              href={cta.href}
              class:list={[
                "class-hero__cta",
                index === 0 ? "class-hero__cta--primary" : "class-hero__cta--secondary"
              ]}
            >
              {cta.icon && (
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" set:html={cta.icon} />
              )}
              {cta.label}
            </a>
          ))}
          </div>
        )}
      </div>

      <!-- Right column: HUD with metrics -->
      <div class="class-hero__hud">
      <!-- Background glows -->
      <div class="absolute -right-10 -top-16 h-40 w-40 rounded-full bg-red-500/35 blur-3xl" aria-hidden="true" />
      <div class="absolute bottom-0 left-0 h-44 w-44 -translate-x-1/3 translate-y-1/3 rounded-full bg-cyan-400/25 blur-3xl" aria-hidden="true" />

      <!-- Metrics grid -->
      <div class="relative grid grid-cols-2 gap-4 text-center">
        {metrics.map((metric) => (
          <div
            class="group rounded-2xl border border-white/10 bg-gradient-to-b from-white/10 to-transparent px-4 py-6 shadow-[0_0_35px_rgba(237,32,36,0.25)] transition duration-300 hover:-translate-y-1 hover:border-red-400/50 hover:shadow-[0_0_45px_rgba(237,32,36,0.35)]"
          >
            <span
              class:list={[
                "block font-rajdhani text-4xl drop-shadow-[0_0_25px_rgba(0,0,0,0.45)] transition duration-300",
                metric.accent === "red" ? "text-red-200 group-hover:text-red-100" : "text-cyan-200 group-hover:text-cyan-100",
              ]}
            >
              {metric.value}
            </span>
            <p class="mt-2 text-[10px] uppercase tracking-[0.35em] text-slate-300/70">
              {metric.label}
            </p>
          </div>
        ))}
      </div>

      <!-- Stack orbital -->
      {stack && stack.length > 0 && (
        <div class="relative mt-6 rounded-2xl border border-white/10 bg-white/5 px-4 py-4 text-left backdrop-blur">
          <span class="text-xs uppercase tracking-[0.4em] text-red-200">Stack de clase</span>
          <div class="mt-3 flex flex-wrap gap-2">
            {stack.slice(0, 6).map((item) => (
              <span class="rounded-full border border-white/20 bg-white/10 px-3 py-1 text-xs text-slate-100/80">
                {item}
              </span>
            ))}
            {stack.length > 6 && (
              <span class="rounded-full border border-red-400/60 bg-red-500/20 px-3 py-1 text-xs text-red-100/80">
                +{stack.length - 6} más
              </span>
            )}
          </div>
        </div>
      )}
      </div>
    </div>
  </div>
</section>

<style>
  .class-hero {
    min-height: 100vh;
    display: flex;
    align-items: center;
    position: relative;
    background: linear-gradient(
      180deg,
      #050509 0%,
      #0a0a12 35%,
      #12121e 100%
    );
  }

  .class-hero__background {
    position: absolute;
    inset: 0;
    overflow: hidden;
    z-index: 0;
  }

  .class-hero__vinyl {
    position: absolute;
    top: 50%;
    right: 5%;
    width: 55%;
    max-width: 750px;
    height: auto;
    transform: translateY(-50%);
    opacity: 0.45;
    filter: drop-shadow(0 0 60px rgba(237, 32, 36, 0.4));
    animation: float 8s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(-50%) translateX(0) rotate(0deg);
    }
    25% {
      transform: translateY(-52%) translateX(-2%) rotate(1deg);
    }
    50% {
      transform: translateY(-48%) translateX(0) rotate(-1deg);
    }
    75% {
      transform: translateY(-52%) translateX(2%) rotate(0.5deg);
    }
  }

  .class-hero__overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      90deg,
      rgba(5, 5, 9, 0.95) 0%,
      rgba(5, 5, 9, 0.75) 40%,
      rgba(5, 5, 9, 0.3) 70%,
      rgba(5, 5, 9, 0.6) 100%
    );
    z-index: 1;
  }

  .class-hero__content {
    position: relative;
    z-index: 2;
    width: 100%;
    max-width: 1440px;
    margin: 0 auto;
    padding: 6rem 2rem;
    display: grid;
    gap: 4rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 1024px) {
    .class-hero__content {
      grid-template-columns: 1fr;
      gap: 3rem;
      padding: 6rem 4rem;
      max-width: 1200px;
    }
  }

  .class-hero__breadcrumb {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    margin-bottom: 1rem;
  }

  .class-hero__breadcrumb-link {
    color: rgba(203, 213, 225, 0.7);
    transition: color 0.2s;
  }

  .class-hero__breadcrumb-link:hover {
    color: rgba(237, 32, 36, 1);
  }

  .class-hero__breadcrumb-separator {
    color: rgba(203, 213, 225, 0.4);
  }

  .class-hero__breadcrumb-current {
    color: rgba(237, 32, 36, 0.9);
    font-weight: 500;
  }

  .class-hero__title {
    font-family: "Rajdhani", sans-serif;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    font-weight: 700;
    line-height: 1.1;
    letter-spacing: -0.02em;
  }

  .class-hero__cta {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: all 0.3s;
    border: 1px solid transparent;
  }

  .class-hero__cta--primary {
    background: linear-gradient(135deg, #ED2024, #b31619);
    color: white;
    box-shadow: 0 0 30px rgba(237, 32, 36, 0.4);
  }

  .class-hero__cta--primary:hover {
    background: linear-gradient(135deg, #ff2428, #ED2024);
    box-shadow: 0 0 45px rgba(237, 32, 36, 0.6);
    transform: translateY(-2px);
  }

  .class-hero__cta--secondary {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(8px);
  }

  .class-hero__cta--secondary:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(0, 188, 212, 0.5);
    color: white;
    transform: translateY(-2px);
  }

  .class-hero__hud {
    position: relative;
    padding: 2rem;
    border-radius: 1.5rem;
    background: linear-gradient(
      135deg,
      rgba(17, 17, 24, 0.92),
      rgba(28, 28, 46, 0.68)
    );
    border: 1px solid rgba(237, 32, 36, 0.3);
    backdrop-filter: blur(18px);
    box-shadow: 0 0 45px rgba(237, 32, 36, 0.2);
  }

  @media (max-width: 1023px) {
    .class-hero__vinyl {
      right: -30%;
      width: 90%;
      opacity: 0.2;
    }

    .class-hero__overlay {
      background: linear-gradient(
        180deg,
        rgba(5, 5, 9, 0.9) 0%,
        rgba(5, 5, 9, 0.85) 50%,
        rgba(5, 5, 9, 0.9) 100%
      );
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .class-hero__vinyl {
      animation: none;
    }
  }
</style>
